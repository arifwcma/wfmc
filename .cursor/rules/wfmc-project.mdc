# WFMC Project

Flutter app (Android / iOS / Web) for viewing Wimmera flood maps from QGIS Server.

## Startup Defaults

- **All study groups enabled** on first launch
- **Only the 100-year (ARI100) layer per group** enabled — no other return periods
- Defaults are defined in `lib/config/app_config.dart` (`defaultEnabledStudies`, `defaultEnabledLayers`)
- Do NOT auto-change the layer selection on startup (no auto-locate)
- The map zooms to fit the WCMA boundary on startup

## Locate Me Behaviour

- Triggered **only** by the user pressing the Locate Me FAB — never automatic
- Zooms to the user's GPS position
- Auto-selects the closest study's 100-year layer (replaces current selection)

## Study Metadata

- `lib/config/study_metadata.dart` maps each study to its display name, completion year, report URL, and 100yr layer names
- Report URLs are currently stubs — update with real CMA website links when available

## Writing Constraints

- Only write files inside the `wfmc` project folder
- Do NOT modify `wfma` or `wfml` without explicit permission

## Key Files

| Path | Description |
|---|---|
| `lib/main.dart` | Entry point, tile cache init |
| `lib/config/app_config.dart` | Default studies/layers, basemap config |
| `lib/config/study_metadata.dart` | Study display names, years, report URLs |
| `lib/screens/home_screen.dart` | Main map UI, all features |
| `lib/screens/about_screen.dart` | About Wimmera CMA page |
| `lib/services/wms_tile_provider.dart` | WMS tile provider + offline cache |
| `lib/services/location_service.dart` | GPS wrapper |
| `lib/services/geocoding_service.dart` | Nominatim address search |
| `lib/services/bookmark_service.dart` | Saved locations CRUD |
| `lib/widgets/study_list.dart` | Layer selection drawer UI |
| `lib/widgets/place_search_delegate.dart` | Address search UI |

## WMS Server

- Endpoint: `https://wimmera.xyz/qgis/`
- Map path: `/var/www/qgis/wfma/wfma.qgs`
- CRS: EPSG:3857
- Format: image/png, transparent

## Running

```bash
flutter run -d edge     # Web (Edge)
flutter run -d chrome   # Web (Chrome)
flutter run             # Android device/emulator
```
